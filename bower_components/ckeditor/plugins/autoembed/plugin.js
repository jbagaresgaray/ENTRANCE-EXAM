/*
 Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
(function(){function k(a,e){var b=a.editable().findOne('a[data-cke-autoembed="'+e+'"]'),c=a.lang.autoembed,d;if(b&&b.data("cke-saved-href")){var b=b.data("cke-saved-href"),f=CKEDITOR.plugins.autoEmbed.getWidgetDefinition(a,b);if(f){var g="function"==typeof f.defaults?f.defaults():f.defaults,g=CKEDITOR.dom.element.createFromHtml(f.template.output(g)),h,i=a.widgets.wrapElement(g,f.name),j=new CKEDITOR.dom.documentFragment(i.getDocument());j.append(i);(h=a.widgets.initOn(g,f))?(d=a.showNotification(c.embeddingInProgress,
"info"),h.loadContent(b,{noNotifications:!0,callback:function(){var b=a.editable().findOne('a[data-cke-autoembed="'+e+'"]'),c=a.createRange();b&&(c.setStartAt(b,CKEDITOR.POSITION_BEFORE_START),c.setEndAt(b,CKEDITOR.POSITION_AFTER_END),a.editable().insertElementIntoRange(i,c));d.hide();a.widgets.finalizeCreation(j)},errorCallback:function(){d.hide();a.widgets.destroy(h,!0);a.showNotification(c.embeddingFailed,"info")}})):a.widgets.finalizeCreation(j)}else window.console&&window.console.log("[CKEDITOR.plugins.autoEmbed] Incorrect config.autoEmbed_widget value. No widget definition found.")}}
var l=/^<a[^>]+href="([^"]+)"[^>]*>([^<]+)<\/a>$/i;CKEDITOR.plugins.add("autoembed",{requires:"autolink,undo",lang:"cs,en,it,nb,pl,zh",init:function(a){var e=1,b;a.on("paste",function(c){if(c.data.dataTransfer.getTransferType(a)==CKEDITOR.DATA_TRANSFER_INTERNAL)b=0;else{var d=c.data.dataValue.match(l);if(b=null!=d&&decodeURI(d[1])==decodeURI(d[2]))c.data.dataValue='<a data-cke-autoembed="'+ ++e+'"'+c.data.dataValue.substr(2)}},null,null,20);a.on("afterPaste",function(){b&&k(a,e)})}});CKEDITOR.plugins.autoEmbed=
{getWidgetDefinition:function(a,e){var b=a.config.autoEmbed_widget||"embed,embedSemantic",c,d=a.widgets.registered;if("string"==typeof b)for(b=b.split(",");c=b.shift();){if(d[c])return d[c]}else if("function"==typeof b)return d[b(e)];return null}}})();